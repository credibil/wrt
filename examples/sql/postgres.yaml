name: sql

services:
  sql:
    extends:
      file: ../../docker/service.yaml
      service: wasm32
    build:
      args:
        FEATURES: http,otel,sql,postgres
    volumes:
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql
    depends_on:
      - postgres
      - otelcol

  postgres:
    extends:
      file: oci://ghcr.io/credibil/compose-resources:latest
      service: postgres

include:
  - oci://ghcr.io/credibil/compose-opentelemetry:latest
